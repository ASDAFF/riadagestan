window.RS||(window.RS={}),RS.MainMenu=function(){var e=function(e){this.$el=$("#"+e);var i=this.$el.find(".has-dropdown");this.$el.css({overflow:"hidden","max-height":this.$el.height(),opacity:"0"}),$(window).on("resize",BX.debounce(BX.proxy(this.resizeMenu,this),250)),$(document).ready(BX.proxy(this.resizeMenu,this)),i.on({mouseenter:this.reveal,mouseleave:this.conceal}),i.one("mouseenter",$.proxy(this.hLoadItems,this))};return e.prototype.resizeMenu=function(){var e,i=this.$el.children(),t=i.filter(".is-more"),n=this.$el.outerWidth(),o=0,r=0;for(i.show(),r=t.width(),i.filter(":not(.is-more)").each(function(e,t){var r=$(t).width();return o+r>n?(i.filter(":gt("+(e-1)+")").hide(),!1):(o+=r,!0)});;){if(!(o+r>n)){i.length-1>i.filter(":visible").length?((e=i.filter(":hidden:not(.is-more)").clone().show()).find(".b-main-menu-item__dropdown").remove(),t.find(".b-main-menu-item__dropdown").html(e),t.show()):(t.hide(),t.find(".b-main-menu-item__dropdown").html(""));break}var s=i.filter(":visible:last");o-=s.width(),s.hide()}this.$el.css({overflow:"initial","max-height":"none",opacity:"1",visibility:"visible"})},e.prototype.reveal=function(){var e=$(this),i=e.children(".b-main-menu-item__dropdown");e.offset().left+200>$(window).width()&&i.css("right","0"),i.velocity("stop").velocity("transition.slideDownIn",{duration:250,delay:0})},e.prototype.conceal=function(){var e=$(this).children(".b-main-menu-item__dropdown");e.velocity("stop").velocity("transition.fadeOut",{duration:100,delay:0,complete:function(){e.css("right","auto")}})},e.prototype.hLoadItems=function(e){var i,t,n,o,r;i=$(e.currentTarget),n=i.find(".l-mm-catalog-items"),t=i.children("a.b-main-menu-item__link"),o=$("<div>").addClass("spinner"),r=t.attr("href"),n.html(o),r&&$.getJSON(r,{isAjax:"Y",action:"mm"},function(e){var i,t;i=$("<div>"),(e.content||{}).items&&(i.append(e.content.items),t=i.children(),n.append(t),(RS.Animations||{}).slideUpInElements&&RS.Animations.slideUpInElements(t).then(function(){o.remove()}))})},e}();